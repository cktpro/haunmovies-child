jQuery(document).ready(function(t){function e(t,e=3e3){const n=document.createElement("div");n.textContent=t,n.style.position="fixed",n.style.top="20px",n.style.left="50%",n.style.background="rgba(0,0,0,0.85)",n.style.color="#fff",n.style.padding="12px 20px",n.style.borderRadius="8px",n.style.fontSize="14px",n.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)",n.style.zIndex="9999",n.style.opacity="0",n.style.transition="opacity 0.3s ease",document.body.appendChild(n),setTimeout(()=>{n.style.opacity="1"},50),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.remove()},300)},e)}const n=function(){const n=t("#ratingModal"),a=n.find(".movie-rating-rating-option"),i=t("#submitRatingBtn"),o=parseInt(t("span.rating-votes").text(),10);let s=0;a.on("mouseenter",function(){const e=t(this).data("value");a.each(function(){t(this).toggleClass("hovered",t(this).data("value")<=e)})}).on("mouseleave",function(){a.removeClass("hovered")}),a.on("click",function(){s=t(this).data("value"),a.removeClass("selected"),t(this).addClass("selected")}),i.on("click",function(){if(!s)return void alert("Vui lòng chọn đánh giá trước khi gửi!");const a=n.data("post-id");i.prop("disabled",!0).text("Đang gửi..."),t.ajax({url:halim_rate.ajaxurl,method:"POST",data:{action:"halim_rate_post",nonce:halim_rate.nonce,post:a,value:s},dataType:"text",success:function(a){"Voted"!=a?(t("span.score").html(a),t("span.rating-votes").html(o+1),e("Cảm ơn bạn đã đánh giá!")):e("Bạn đã đánh giá phim này rồi!"),n.removeClass("active"),i.prop("disabled",!1).text("Gửi đánh giá")},error:function(t,e,n){console.error(n),alert("Có lỗi xảy ra, vui lòng thử lại!"),i.prop("disabled",!1).text("Gửi đánh giá")}})}),n.find(".close-modal-rating").on("click",function(){n.removeClass("active")}),t(document).on("click",".halim-rating-button",function(){const e=t(this).data("post-id");t(this).data("rating"),t(this).data("votes");n.data("post-id",e),n.addClass("active")})};n()});